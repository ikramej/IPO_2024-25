<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inicio</title>
  <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
  <link rel="stylesheet" href="../style/style.css">
</head>
<body>
  <div class="iphone-15">
    <div class="screen">
      <div class="dynamic-island"></div>

      <div class="top-bar">
        <input class="search-bar" placeholder="B√∫squeda üîç" />
        <div class="top-icons">
          <div class="icon-menu" onclick="toggleDropdown()">‚ò∞</div>
          <div class="icon-settings" onclick="toggleSettingsDropdown()">‚öôÔ∏è</div>
          <!-- Dropdown para vista -->
          <div id="viewDropdown" class="dropdown-menu">
            <div class="selected">Carpetas</div>
            <div>Listas</div>
        </div>

        </div>

        <!-- Dropdown -->
        <div id="dropdown" class="dropdown-menu">
          <div>Nombre</div>
          <div>Fecha ASC</div>
          <div>Fecha DESC</div>
          <div>Visitado</div>
          <div class="selected">Favoritos</div>
        </div>
      </div>
      
      <!-- Secci√≥n Estad√≠stica -->
      <div class="section">
        <div class="section-name star">Estad√≠stica</div>
        <div class="cards-row">
          <div class="card" onclick="mostrarCardOptions(event)">üìÇ Tema 3.1</div>
          <div class="card" onclick="mostrarCardOptions(event)">üìñ Ejercicios ‚≠ê</div>
        </div>
      </div>

      <!-- Secci√≥n Matem√°tica -->
      <div class="section">
        <div class="section-name">Matem√°tica Discreta y √Ålgebra</div>
        <div class="cards-row">
          <div class="card" onclick="mostrarCardOptions(event)">üìñ Vectores</div>
          <div class="card" onclick="mostrarCardOptions(event)">üìñ Tema 1</div>
        </div>
      </div>

      <!-- Modal al hacer clic en un apunte -->
      <div id="cardOptions" class="dropdown-menu" style="display: none; position: absolute;">
        <div onclick="editarApunte()">‚úèÔ∏è Editar</div>
        <div onclick="mostrarModalEliminar('Tema 1: Action Potentials')">üóëÔ∏è Eliminar</div>
        <div onclick="mostrarModalCompartir()">üì§ Compartir a...</div>
        <div onclick="exportarApunte()">üìÅ Exportar a...</div>
      </div>

      <!-- Modal de Confirmaci√≥n -->
      <div id="deleteModal" class="delete-modal hidden">
        <div class="modal-content">
          <p><strong>¬øEst√°s seguro de eliminar?</strong></p>
          <p id="nombreApunte">TEMA 1: ACTION POTENTIALS</p>
          <div class="modal-buttons">
            <button onclick="cerrarModalEliminar()" class="btn-cancelar">Cancelar</button>
            <button onclick="cerrarModalEliminar()" class="btn-eliminar">Eliminar</button>
          </div>
        </div>
      </div>

      <!-- Modal Compartir -->
<div id="modalCompartir" class="modal hidden">
  <div class="modal-content">
    <h3>Compartir con...</h3>
    <div class="row">
      <span>Sonia.P</span>
      <select>
        <option>Lectura</option>
        <option>Escritura</option>
      </select>
    </div>
    <div class="row">
      <span>a√±adir amigo</span>
      <select>
        <option>Lectura</option>
        <option>Escritura</option>
      </select>
    </div>
    <div class="actions">
      <button class="cancel" onclick="cerrarModales()">Cancelar</button>
      <button class="confirm" onclick="compartirExterno()">Compartir</button>
    </div>
    <button class="external-btn" onclick="abrirModalExterno()">Compartir externamente</button>
  </div>
</div>

<!-- Modal Compartir Externamente -->
<div id="modalExterno" class="modal hidden">
  <div class="modal-content externo">
    <div class="drag-bar"></div>
    <div class="top-bar">
      <h3>Compartir</h3>
      <button class="close" onclick="cerrarModalExterno()">‚úñ</button>
    </div>
    <p style="margin-top: 0; margin-bottom: 10px; font-size: 14px;">Selecciona con qui√©n o c√≥mo compartir</p>

    <!-- Perfiles -->
    <div class="avatars">
      <div style="text-align: center;">
        <img src="https://randomuser.me/api/portraits/women/1.jpg" />
        <div style="font-size: 12px;">Sonia.P</div>
      </div>
      <div style="text-align: center;">
        <img src="https://randomuser.me/api/portraits/men/2.jpg" />
        <div style="font-size: 12px;">Kevin L.</div>
      </div>
      <div style="text-align: center;">
        <img src="https://randomuser.me/api/portraits/women/3.jpg" />
        <div style="font-size: 12px;">Juliana</div>
      </div>
      <div style="text-align: center;">
        <img src="https://randomuser.me/api/portraits/women/4.jpg" />
        <div style="font-size: 12px;">Ana G.</div>
      </div>
    </div>

    <!-- Aplicaciones -->
    <div class="apps">
      <div style="text-align: center;">
        <img src="https://cdn-icons-png.flaticon.com/512/888/888882.png" width="32" />
        <div>OneDrive</div>
      </div>
      <div style="text-align: center;">
        <img src="https://cdn-icons-png.flaticon.com/512/2702/2702602.png" width="32" />
        <div>Drive</div>
      </div>
      <div style="text-align: center;">
        <img src="https://cdn-icons-png.flaticon.com/512/5968/5968885.png" width="32" />
        <div>Notion</div>
      </div>
    </div>

    <input type="text" placeholder="Copy link" />
    <a href="#" class="edit" onclick="cerrarModalExterno()">Edit Actions...</a>
  </div>
</div>





      <div class="floating-buttons">
        <a href="../templates/pantallaMiCirculo.html"><div class="circle-btn">
          <img src="../images/image 6.png" alt="Custom Circle Icon" />
        </div></a>
        
        <a href="">
        <div class="circle-btn plus-btn">
          
        <iconify-icon  icon="humbleicons:plus" style="font-size: 33px; color: white;"></iconify-icon>
        </div>
      
      </div>
    </a>

      <div class="bottom-bar">
        <a href="../templates/main.html"><iconify-icon icon="mingcute:world-2-line"></iconify-icon></a>
        <iconify-icon icon="tabler:pencil" class="active"></iconify-icon></a>
        <a href="../templates/notificaciones.html"><iconify-icon icon="bx:bell"></iconify-icon></a>
        <a href="../templates/pantallaPerfil.html"><iconify-icon icon="mingcute:user-2-line"></iconify-icon>
      </a>
    </div>
    </div>
  </div>
  <script>
    // Asignar valores aleatorios a cada card al cargar
    const cards = document.querySelectorAll(".card");
    cards.forEach(card => {
      card.dataset.fecha = Math.floor(Math.random() * 100);     // N√∫mero aleatorio (0‚Äì99)
      card.dataset.visitado = Math.floor(Math.random() * 100);  // Otro valor aleatorio
    });
  
    // Mostrar/ocultar el men√∫
    function toggleDropdown() {
      document.getElementById("dropdown").classList.toggle("active");
    }
  
    // Cierra el dropdown si haces clic fuera
    window.addEventListener('click', function (e) {
      const dropdown = document.getElementById('dropdown');
      if (!e.target.closest('.icon-menu') && !e.target.closest('.dropdown-menu')) {
        dropdown.classList.remove('active');
      }
    });
  
    // L√≥gica del filtro
    const dropdownItems = document.querySelectorAll("#dropdown div");
  
    dropdownItems.forEach(item => {
      item.addEventListener("click", () => {
        // Visual
        dropdownItems.forEach(i => i.classList.remove("selected"));
        item.classList.add("selected");
  
        document.getElementById("dropdown").classList.remove("active");
        const filter = item.textContent.trim();
  
        let sortedCards = Array.from(cards);
  
        if (filter === "Favoritos") {
          // Mostrar solo los que tienen estrella
          cards.forEach(card => {
            card.style.display = card.textContent.includes("‚≠ê") ? "block" : "none";
          });
          return;
        }
  
        // Ordenar
        if (filter === "Nombre") {
          sortedCards.sort((a, b) => a.textContent.localeCompare(b.textContent));
        } else if (filter === "Fecha ASC") {
          sortedCards.sort((a, b) => a.dataset.fecha - b.dataset.fecha);
        } else if (filter === "Fecha DESC") {
          sortedCards.sort((a, b) => b.dataset.fecha - a.dataset.fecha);
        } else if (filter === "Visitado") {
          sortedCards.sort((a, b) => b.dataset.visitado - a.dataset.visitado);
        }
  
        // Reinsertar ordenado
        const rows = document.querySelectorAll(".cards-row");
        rows.forEach(row => row.innerHTML = "");
  
        let index = 0;
        for (let row of rows) {
          for (let i = 0; i < 2 && index < sortedCards.length; i++, index++) {
            row.appendChild(sortedCards[index]);
          }
        }
      });
    });

    // Mostrar/ocultar men√∫ de configuraci√≥n
    function toggleSettingsDropdown() {
      document.getElementById("viewDropdown").classList.toggle("active");
    }

    // Cierra el dropdown si haces clic fuera
    window.addEventListener('click', function (e) {
      const settingsDropdown = document.getElementById('viewDropdown');
      const settingsIcon = document.querySelector('.icon-settings');

      if (!e.target.closest('.icon-settings') && !e.target.closest('#viewDropdown')) {
        settingsDropdown.classList.remove('active');
      }
    });

    // Manejar cambios de vista (Carpetas o Listas)
    const viewItems = document.querySelectorAll("#viewDropdown div");
    const sections = document.querySelectorAll(".section");

    viewItems.forEach(item => {
      item.addEventListener("click", () => {
        viewItems.forEach(i => i.classList.remove("selected"));
        item.classList.add("selected");
        document.getElementById("viewDropdown").classList.remove("active");

        const mode = item.textContent.trim().replace("‚úî", "");

        sections.forEach(section => {
          const row = section.querySelector(".cards-row");
          if (!row) return;

          if (mode === "Listas") {
            row.style.flexDirection = "column";
            row.querySelectorAll(".card").forEach(card => {
              card.classList.add("list-view");
            });
          } else {
            row.style.flexDirection = "row";
            row.querySelectorAll(".card").forEach(card => {
              card.classList.remove("list-view");
            });
          }

        });
      });
    });

        function mostrarCardOptions(e) {
      e.stopPropagation();
      const menu = document.getElementById("cardOptions");
      const card = e.currentTarget;

      // Obtener posici√≥n relativa al contenedor padre (.screen)
      const top = card.offsetTop + card.offsetHeight;
      const left = card.offsetLeft;

      menu.style.top = `${top}px`;
      menu.style.left = `${left}px`;
      menu.style.display = "block";
    }


    // Cerrar el men√∫ al hacer clic fuera
    window.addEventListener("click", () => {
      const menu = document.getElementById("cardOptions");
      menu.style.display = "none";
    });

    // Acciones de las opciones
    function editarApunte() {
      window.location.href = "../templates/editarApunte.html";
    }

    function borrarApunte() {
      alert("¬øBorrar este apunte?");
    }

    function compartirApunte() {
      alert("Compartir apunte...");
    }

    function exportarApunte() {
      alert("Exportar apunte...");
    }

    function mostrarModalEliminar(nombre) {
      document.getElementById("nombreApunte").textContent = nombre;
      document.getElementById("deleteModal").classList.remove("hidden");
      document.getElementById("cardOptions").style.display = "none";
    }

    function cerrarModalEliminar() {
      document.getElementById("deleteModal").classList.add("hidden");
    }

    function mostrarModalCompartir() {
    document.getElementById("modalCompartir").classList.remove("hidden");
  }

  function mostrarModalExterno() {
    document.getElementById("modalCompartir").classList.add("hidden");
    document.getElementById("modalCompartirExterno").classList.remove("hidden");
  }

  function cerrarModales() {
    document.getElementById("modalCompartir").classList.add("hidden");
    document.getElementById("modalCompartirExterno").classList.add("hidden");
  }

  function abrirModalExterno() {
  document.getElementById('modalExterno').classList.remove('hidden');
}

function cerrarModalExterno() {
  document.getElementById('modalExterno').classList.add('hidden');
}

  function compartirExterno() {
    // Aqu√≠ ir√≠a l√≥gica real
    cerrarModales();
  }

  </script>
  
</body>
</html>
